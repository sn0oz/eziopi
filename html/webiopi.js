var _gaq=_gaq||[];var _webiopi;function w(){if(_webiopi==undefined){_webiopi=new WebIOPi()}return _webiopi}function webiopi(){return w()}var isTouchDevice="ontouchstart" in document.documentElement?true:false;var BUTTON_DOWN=isTouchDevice?"touchstart":"mousedown";var BUTTON_UP=isTouchDevice?"touchend":"mouseup";function WebIOPi(){this.readyCallback=null;this.context="/";this.GPIO=Array(54);this.PINS=Array(27);this.TYPE={DNC:{value:0,style:"DNC",label:"--"},GND:{value:1,style:"GND",label:"GROUND"},V33:{value:2,style:"V33",label:"3.3V"},V50:{value:3,style:"V50",label:"5.0V"},GPIO:{value:4,style:"GPIO",label:"GPIO"}};this.ALT={I2C:{name:"I2C",enabled:false,gpios:[]},SPI:{name:"SPI",enabled:false,gpios:[]},UART:{name:"UART",enabled:false,gpios:[]},ONEWIRE:{name:"ONEWIRE",enabled:false,gpios:[]}};for(var f=0;f<this.GPIO.length;f++){var b=Object();b.value=0;b.func="IN";b.mapped=false;this.GPIO[f]=b}var c=new RegExp("http://"+window.location.host+"(.*)webiopi.js");var e=document.getElementsByTagName("script");for(var f=0;f<e.length;f++){var g=c.exec(e[f].src);if(g&&(g.length>1)){script=e[f];this.context=g[1]}}var h=document.getElementsByTagName("head")[0];var d=document.createElement("script");d.type="text/javascript";d.src="/jquery.js";d.onload=function(){w().init()};h.appendChild(d);_gaq.push(["_setAccount","UA-33979593-2"]);_gaq.push(["_trackPageview"]);var j=document.createElement("script");j.type="text/javascript";j.async=false;j.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";h.appendChild(j);var a=document.createElement("link");a.rel="stylesheet";a.type="text/css";a.href="/webiopi.css";h.appendChild(a);this.addALT(this.ALT.I2C,0,"SDA");this.addALT(this.ALT.I2C,1,"SCL");this.addALT(this.ALT.I2C,2,"SDA");this.addALT(this.ALT.I2C,3,"SCL");this.addALT(this.ALT.SPI,7,"CE1");this.addALT(this.ALT.SPI,8,"CE0");this.addALT(this.ALT.SPI,9,"MISO");this.addALT(this.ALT.SPI,10,"MOSI");this.addALT(this.ALT.SPI,11,"SCLK");this.addALT(this.ALT.UART,14,"TX");this.addALT(this.ALT.UART,15,"RX");this.addALT(this.ALT.ONEWIRE,4,"")}WebIOPi.prototype.init=function(){$.getJSON(w().context+"map",function(d){var c=w().PINS.length;for(i=0;i<c-1;i++){var b=w().TYPE.GPIO;var a=d[i];if(a=="DNC"){b=w().TYPE.DNC}else{if(a=="GND"){b=w().TYPE.GND}else{if(a=="V33"){b=w().TYPE.V33}else{if(a=="V50"){b=w().TYPE.V50}}}}if(b.value!=w().TYPE.GPIO.value){a=b.label}w().map(i+1,b,a)}if(w().readyCallback!=null){w().readyCallback()}w().checkVersion()})};WebIOPi.prototype.ready=function(a){w().readyCallback=a};WebIOPi.prototype.map=function(a,b,c){w().PINS[a]=Object();w().PINS[a].type=b;w().PINS[a].value=c;if(b.value==w().TYPE.GPIO.value){w().GPIO[c].mapped=true}};WebIOPi.prototype.addALT=function(c,a,b){var d=Object();d.gpio=a;d.name=b;c.gpios.push(d)};WebIOPi.prototype.updateValue=function(a,c){w().GPIO[a].value=c;var b=(c==1)?"HIGH":"LOW";$("#gpio"+a).attr("class",b)};WebIOPi.prototype.updateFunction=function(a,b){w().GPIO[a].func=b;$("#function"+a).val(b);$("#function"+a).text(b)};WebIOPi.prototype.updateSlider=function(a,b,c){$("#"+b+a).val(c)};WebIOPi.prototype.updateALT=function(c,a){for(var b in c.gpios){gpio=c.gpios[b].gpio;$("#description"+gpio).empty();if(a){$("#description"+gpio).append(c.name+" "+c.gpios[b].name);$("#gpio"+gpio).attr("class",c.name);$("#function"+gpio).attr("class","FunctionSpecial")}else{$("#description"+gpio).append("GPIO "+gpio);$("#gpio"+gpio).attr("class","");$("#function"+gpio).attr("class","FunctionBasic")}}c.enabled=a};WebIOPi.prototype.refreshGPIO=function(a){$.getJSON(w().context+"*",function(b){w().updateALT(w().ALT.I2C,b.I2C);w().updateALT(w().ALT.SPI,b.SPI);w().updateALT(w().ALT.UART,b.UART);w().updateALT(w().ALT.ONEWIRE,b.ONEWIRE);$.each(b.GPIO,function(c,d){w().updateFunction(c,d["function"]);if(((c!=4)&&((d["function"]=="IN")||(d["function"]=="OUT"))||((c==4)&&(w().ALT.ONEWIRE.enabled==false)))){w().updateValue(c,d.value)}else{if(d["function"]=="PWM"){w().updateSlider(c,"ratio",d.ratio);w().updateSlider(c,"angle",d.angle)}}})});if(a===true){setTimeout(function(){w().refreshGPIO(a)},1000)}};WebIOPi.prototype.checkVersion=function(){var a;$.get(w().context+"version",function(b){_gaq.push(["_trackEvent","version",b])})};WebIOPi.prototype.digitalRead=function(a,b){if(b!=undefined){$.get(w().context+"GPIO/"+a+"/value",function(c){w().updateValue(a,c);b(a,c)})}return w().GPIO[a].value};WebIOPi.prototype.digitalWrite=function(a,b,c){if(w().GPIO[a].func.toUpperCase()=="OUT"){$.post(w().context+"GPIO/"+a+"/value/"+b,function(d){w().updateValue(a,d);if(c!=undefined){c(a,d)}})}else{}};WebIOPi.prototype.getFunction=function(a,b){if(b!=undefined){$.get(w().context+"GPIO/"+a+"/function",function(c){w().updateFunction(a,c);b(a,c)})}return w().GPIO[a].func};WebIOPi.prototype.setFunction=function(a,b,c){$.post(w().context+"GPIO/"+a+"/function/"+b,function(d){w().updateFunction(a,d);if(c!=undefined){c(a,d)}})};WebIOPi.prototype.toggleValue=function(a){var b=(w().GPIO[a].value==1)?0:1;w().digitalWrite(a,b)};WebIOPi.prototype.toggleFunction=function(a){var b=(w().GPIO[a].func=="IN")?"OUT":"IN";w().setFunction(a,b)};WebIOPi.prototype.outputSequence=function(a,b,d,c){$.post(w().context+"GPIO/"+a+"/sequence/"+b+","+d,function(e){w().updateValue(a,e);if(c!=undefined){c(a,e)}})};WebIOPi.prototype.callMacro=function(b,a,c){if(a==undefined){a=""}$.post(w().context+"macros/"+b+"/"+a,function(d){if(c!=undefined){c(b,a,d)}})};WebIOPi.prototype.enablePWM=function(a,b){$.post(w().context+"GPIO/"+a+"/pwm/enable",function(c){if(b!=undefined){b(a,c)}})};WebIOPi.prototype.disablePWM=function(a,b){$.post(w().context+"GPIO/"+a+"/pwm/disable",function(c){if(b!=undefined){b(a,c)}})};WebIOPi.prototype.pulse=function(a,b){$.post(w().context+"GPIO/"+a+"/pulse/",function(c){if(b!=undefined){b(a,c)}})};WebIOPi.prototype.pulseRatio=function(a,b,c){$.post(w().context+"GPIO/"+a+"/pulseRatio/"+b,function(d){if(c!=undefined){c(a,d)}})};WebIOPi.prototype.pulseAngle=function(a,b,c){$.post(w().context+"GPIO/"+a+"/pulseAngle/"+b,function(d){if(c!=undefined){c(a,d)}})};WebIOPi.prototype.setLabel=function(b,a){$("#"+b).val(a);$("#"+b).text(a)};WebIOPi.prototype.setClass=function(b,a){$("#"+b).attr("class",a)};WebIOPi.prototype.createButton=function(e,a,d,c){var b=$('<button type="button" class="Default">');b.attr("id",e);b.text(a);if(d!=undefined){b.bind(BUTTON_DOWN,d)}if(c!=undefined){b.bind(BUTTON_UP,c)}return b};WebIOPi.prototype.createGPIOButton=function(a,b){var c=w().createButton("gpio"+a,b);c.bind(BUTTON_DOWN,function(d){w().toggleValue(a)});return c};WebIOPi.prototype.createFunctionButton=function(a){var b=w().createButton("function"+a," ");b.attr("class","FunctionBasic");b.bind(BUTTON_DOWN,function(c){w().toggleFunction(a)});return b};WebIOPi.prototype.createPulseButton=function(d,b,a){var c=webiopi().createButton(d,b);c.bind(BUTTON_DOWN,function(e){webiopi().pulse(a)});return c};WebIOPi.prototype.createMacroButton=function(e,b,d,a){var c=webiopi().createButton(e,b);c.bind(BUTTON_DOWN,function(f){webiopi().callMacro(d,a)});return c};WebIOPi.prototype.createSequenceButton=function(f,b,a,d,e){var c=webiopi().createButton(f,b);c.bind(BUTTON_DOWN,function(g){webiopi().outputSequence(a,d,e)});return c};WebIOPi.prototype.createRatioSlider=function(a){var b=$('<input type="range" min="0.0" max="1.0" step="0.01">');b.attr("id","ratio"+a);b.bind("change",function(){w().pulseRatio(a,b.val())});return b};WebIOPi.prototype.createAngleSlider=function(a){var b=$('<input type="range" min="-45" max="45" step="1">');b.attr("id","angle"+a);b.bind("change",function(){w().pulseAngle(a,b.val())});return b};WebIOPi.prototype.RPiHeader=function(){if(w()._header==undefined){w()._header=new RPiHeader()}return w()._header};function RPiHeader(){}RPiHeader.prototype.getPinCell=function(b){var a=$('<td align="center">');var c;if(w().PINS[b].type.value==w().TYPE.GPIO.value){c=w().createGPIOButton(w().PINS[b].value,b)}else{var c=$('<button type="button">');c.val(b);c.text(b);c.attr("class",w().PINS[b].type.style)}a.append(c);return a};RPiHeader.prototype.getDescriptionCell=function(b,d){var a=$("<td>");a.attr("align",d);var c=$("<div>");c.attr("class","Description");if(w().PINS[b].type.value!=w().TYPE.GPIO.value){c.append(w().PINS[b].value)}else{c.attr("id","description"+w().PINS[b].value);c.append("GPIO "+w().PINS[b].value)}a.append(c);return a};RPiHeader.prototype.getFunctionCell=function(b){var a=$('<td align="center">');if(w().PINS[b].type.value==w().TYPE.GPIO.value){var c=w().createFunctionButton(w().PINS[b].value);a.append(c)}return a};RPiHeader.prototype.createTable=function(b){var d=$("<table>");d.attr("id","RPiHeader");for(var c=1;c<=26;c++){var a=$("<tr>");a.append(this.getFunctionCell(c));a.append(this.getDescriptionCell(c,"right"));a.append(this.getPinCell(c));c++;a.append(this.getPinCell(c));a.append(this.getDescriptionCell(c,"left"));a.append(this.getFunctionCell(c));d.append(a)}if(b!=undefined){$("#"+b).append(d)}return d};WebIOPi.prototype.Expert=function(){if(w()._expert==undefined){w()._expert=new Expert()}return w()._expert};function Expert(){}Expert.prototype.createGPIO=function(a){var b=$("<div>");b.append(w().createFunctionButton(a));b.append(w().createGPIOButton(a,a));div=$("<div>");div.attr("id","description"+a);div.attr("class","Description");div.append("GPIO "+a);b.append(div);return b};Expert.prototype.createList=function(b){var c=$("<div>");for(i=0;i<w().GPIO.length;i++){if(w().GPIO[i].mapped==true){var a=w().Expert().createGPIO(i);c.append(a)}}if(b!=undefined){$("#"+b).append(c)}return c};WebIOPi.prototype.Serial=function(a){return new Serial(a)};function Serial(a){this.device=a;this.url="/devices/"+a}Serial.prototype.write=function(a){$.post(this.url,a)};Serial.prototype.read=function(a){$.get(this.url,a)};WebIOPi.prototype.newDevice=function(b,a){if(b=="ADC"){return new ADC(a)}if(b=="DAC"){return new DAC(a)}if(b=="PWM"){return new PWM(a)}if(b=="GPIOPort"){return new GPIOPort(a)}if(b=="Temperature"){return new Temperature(a)}if(b=="Pressure"){return new Pressure(a)}if(b=="Luminosity"){return new Luminosity(a)}if(b=="Distance"){return new Distance(a)}if(b=="PiFaceDigital"){return new PiFaceDigital(a)}if(b=="Humidity"){return new Humidity(a)}return undefined};function GPIOPort(b){this.name=b;this.url="/devices/"+b;this.onready=null;this.channelCount=0;this.refreshTime=1000;var a=this;$.get(this.url+"/count",function(c){a.channelCount=parseInt(c)})}GPIOPort.prototype.isReady=function(){return(this.channelCount>0)};GPIOPort.prototype.toString=function(){if(this.channelCount>0){return this.name+": GPIO Port ("+this.channelCount+"-bits)"}return this.name+": GPIO Port"};GPIOPort.prototype.digitalRead=function(b,c){var a=this.name;$.get(this.url+"/"+b+"/value",function(d){c(a,b,d)})};GPIOPort.prototype.digitalWrite=function(b,c,d){var a=this.name;$.post(this.url+"/"+b+"/value/"+c,function(e){d(a,b,e)})};GPIOPort.prototype.setFunction=function(c,b,d){var a=this.name;$.post(this.url+"/"+c+"/function/"+b,function(e){d(a,c,e)})};GPIOPort.prototype.readAll=function(b){var a=this.name;$.get(this.url+"/*",function(c){b(a,c)})};GPIOPort.prototype.refreshUI=function(){var c=this;var f=this.element;if((f!=undefined)&&(f.header==undefined)){f.header=$("<h3>"+this+"</h3>");f.append(f.header)}if((f!=undefined)&&(f.table==undefined)&&this.isReady()){f.header.text(this);f.table=$("<table>");f.append(f.table);var b=$("<tr>");for(var e=this.channelCount-1;e>=0;e--){var a=$("<td>");a.text(1<<e);b.append(a)}f.table.append(b);b=$("<tr>");for(var e=this.channelCount-1;e>=0;e--){var a=$("<td>");var d=webiopi().createButton(this.name+"_"+e+"_value",e,function(){if($("#"+c.name+"_"+$(this).attr("channel")+"_value").attr("class")=="LOW"){value=1}else{value=0}c.digitalWrite($(this).attr("channel"),value,function(g,h,j){if(j=="1"){$("#"+g+"_"+h+"_value").attr("class","HIGH")}else{$("#"+g+"_"+h+"_value").attr("class","LOW")}})});d.attr("channel",e);d.attr("class","LOW");a.append(d);b.append(a)}f.table.append(b);b=$("<tr>");for(var e=this.channelCount-1;e>=0;e--){var a=$("<td>");var d=webiopi().createButton(c.name+"_"+e+"_func","IN",function(){var g=$(this).text();console.log(g);if(g=="IN"){g="OUT"}else{g="IN"}c.setFunction($(this).attr("channel"),g,function(h,k,j){$("#"+c.name+"_"+k+"_func").text(j)})});d.attr("class","FunctionBasic");d.attr("channel",e);a.append(d);b.append(a)}f.table.append(b)}this.readAll(function(g,h){for(e in h){$("#"+g+"_"+e+"_value").attr("class",h[e]["value"]=="1"?"HIGH":"LOW");$("#"+g+"_"+e+"_func").text(h[e]["function"])}setTimeout(function(){c.refreshUI()},c.refreshTime)})};function ADC(a){this.name=a;this.url="/devices/"+a+"/analog";this.channelCount=0;this.maxInteger=0;this.resolution=0;this.refreshTime=1000;var b=this;$.get(this.url+"/count",function(c){b.channelCount=parseInt(c)});$.get(this.url+"/max",function(c){b.maxInteger=parseInt(c)});$.get(this.url+"/resolution",function(c){b.resolution=parseInt(c)})}ADC.prototype.isReady=function(){return(this.channelCount>0&&this.maxInteger>0&&this.resolution>0)};ADC.prototype.toString=function(){if(this.channelCount>0&&this.resolution>0){return this.name+": ADC ("+this.resolution+"-bits, "+this.channelCount+"-channels)"}return this.name+": ADC"};ADC.prototype.readInteger=function(b,c){var a=this.name;$.get(this.url+"/"+b+"/integer",function(d){c(a,b,d)})};ADC.prototype.readFloat=function(b,c){var a=this.name;$.get(this.url+"/"+b+"/float",function(d){c(a,b,d)})};ADC.prototype.readVolt=function(b,c){var a=this.name;$.get(this.url+"/"+b+"/volt",function(d){c(a,b,d)})};ADC.prototype.readAllInteger=function(b){var a=this.name;$.get(this.url+"/*/integer",function(c){b(a,c)})};ADC.prototype.readAllFloat=function(b){var a=this.name;$.get(this.url+"/*/float",function(c){b(a,c)})};ADC.prototype.readAllVolt=function(b){var a=this.name;$.get(this.url+"/*/volt",function(c){b(a,c)})};ADC.prototype.refreshUI=function(){var b=this;var a=this.element;if((a!=undefined)&&(a.header==undefined)){a.header=$("<h3>"+this+"</h3>");a.append(a.header)}if((a!=undefined)&&(a.channels==undefined)&&this.isReady()){a.header.text(this);a.channels=Array();for(i=0;i<this.channelCount;i++){var c=$("<div>");c.text("Channel-"+i);a.append(c);a.channels[i]=c}}this.readAllVolt(function(d,e){for(i in e){if((a!=undefined)&&(a.channels!=undefined)){var f=a.channels[i];f.text("Channel-"+i+": "+parseFloat(e[i]).toFixed(2)+"V")}}setTimeout(function(){b.refreshUI()},b.refreshTime)})};function DAC(b){this.name=b;this.url="/devices/"+b+"/analog";this.channelCount=0;this.maxInteger=0;this.resolution=0;this.vref=0;var a=this;$.get(this.url+"/count",function(c){a.channelCount=parseInt(c)});$.get(this.url+"/max",function(c){a.maxInteger=parseInt(c)});$.get(this.url+"/resolution",function(c){a.resolution=parseInt(c)});$.get(this.url+"/vref",function(c){a.vref=parseFloat(c)})}DAC.prototype.isReady=function(){return(this.channelCount>0&&this.maxInteger>0&&this.resolution>0&&this.vref>0)};DAC.prototype.toString=function(){if(this.channelCount>0&&this.resolution>0){return this.name+": DAC ("+this.resolution+"-bits, "+this.channelCount+"-channels)"}return this.name+": DAC"};DAC.prototype.writeInteger=function(b,c,d){var a=this.name;$.post(this.url+"/"+b+"/integer/"+c,function(e){d(a,b,e)})};DAC.prototype.writeFloat=function(b,c,d){var a=this.name;$.post(this.url+"/"+b+"/float/"+c,function(e){d(a,b,e)})};DAC.prototype.readAllInteger=function(b){var a=this.name;$.get(this.url+"/*/integer",function(c){b(a,c)})};DAC.prototype.readAllFloat=function(b){var a=this.name;$.get(this.url+"/*/float",function(c){b(a,c)})};DAC.prototype.refreshUI=function(){var c=this;var e=this.element;if((e!=undefined)&&(e.header==undefined)){e.header=$("<h3>"+this+"</h3>");e.append(e.header)}if((e!=undefined)&&(e.table==undefined)&&this.isReady()){e.header.text(this);e.table=$("<table>");e.append(e.table);for(var d=0;d<this.channelCount;d++){var b=$("<tr>");var a;a=$("<td>");a.text("Channel-"+d);b.append(a);a=$("<td>");var g=$('<input type="range" min="0" max="100" step="1" value="0">');g.attr("channel",d);g.attr("id","slider_"+this.name+"_"+d);a.append(g);b.append(a);a=$("<td>");var f=$("<span>");f.attr("id","span_"+this.name+"_"+d);a.append(f);b.append(a);g.bind("change",function(){c.writeFloat($(this).attr("channel"),$(this).val()/100,function(h,k,l){var m=(l*100).toFixed(0);var j=(l*c.vref).toFixed(2);$("#span_"+h+"_"+k).text(j+"V - "+m+"%");$("#slider_"+h+"_"+k).val(m)})});e.table.append(b)}this.readAllFloat(function(h,k){for(d in k){var l=(k[d]*100).toFixed(0);var j=(k[d]*c.vref).toFixed(2);$("#span_"+h+"_"+d).text(j+"V - "+l+"%");$("#slider_"+h+"_"+d).val(l)}})}else{setTimeout(function(){c.refreshUI()},1000)}};function PWM(a){this.name=a;this.url="/devices/"+a+"/pwm";this.channelCount=0;this.maxInteger=0;this.resolution=0;this.refreshTime=1000;var b=this;$.get(this.url+"/count",function(c){b.channelCount=parseInt(c)});$.get(this.url+"/max",function(c){b.maxInteger=parseInt(c)});$.get(this.url+"/resolution",function(c){b.resolution=parseInt(c)})}PWM.prototype.isReady=function(){return(this.channelCount>0&&this.maxInteger>0&&this.resolution>0)};PWM.prototype.toString=function(){if(this.channelCount>0&&this.resolution>0){return this.name+": PWM ("+this.resolution+"-bits, "+this.channelCount+"-channels)"}return this.name+": PWM"};PWM.prototype.writeInteger=function(b,c,d){var a=this.name;$.post(this.url+"/"+b+"/integer/"+c,function(e){d(a,b,e)})};PWM.prototype.writeFloat=function(b,c,d){var a=this.name;$.post(this.url+"/"+b+"/float/"+c,function(e){d(a,b,e)})};PWM.prototype.writeAngle=function(b,c,d){var a=this.name;$.post(this.url+"/"+b+"/angle/"+c,function(e){d(a,b,e)})};PWM.prototype.readAllInteger=function(b){var a=this.name;$.get(this.url+"/*/integer",function(c){b(a,c)})};PWM.prototype.readAllFloat=function(b){var a=this.name;$.get(this.url+"/*/float",function(c){b(a,c)})};PWM.prototype.readAll=function(b){var a=this.name;$.get(this.url+"/*",function(c){b(a,c)})};PWM.prototype.refreshUI=function(){var b=this;var c=this.element;if((c!=undefined)&&(c.header==undefined)){c.header=$("<h3>"+this+"</h3>");c.append(c.header)}if((c!=undefined)&&(c.table==undefined)&&this.isReady()){c.header.text(this);c.table=$("<table>");c.append(c.table);for(var d=0;d<this.channelCount;d++){var j=$("<tr>");var h;h=$("<td>");h.text("Channel-"+d);j.append(h);h=$("<td>");var e=$('<input type="checkbox">');e.attr("id","checkbox_"+this.name+"_"+d);e.attr("channel",d);var f=$("<label>");f.append(e);f.append("Servo");h.append(f);j.append(h);h=$("<td>");var a=$('<input type="range" min="0" max="100" step="1" value="0">');a.attr("channel",d);a.attr("id","slider_"+this.name+"_"+d);h.append(a);j.append(h);h=$("<td>");var g=$("<span>");g.attr("id","span_"+this.name+"_"+d);h.append(g);j.append(h);e.bind("change",function(){var k=$("#slider_"+b.name+"_"+$(this).attr("channel"));k.attr("servo",$(this).is(":checked"))});a.bind("change",function(){if($(this).attr("servo")=="true"){b.writeAngle($(this).attr("channel"),$(this).val(),function(k,l,m){var n=m;$("#span_"+k+"_"+l).text(n+"°");$("#slider_"+k+"_"+l).val(n)})}else{b.writeFloat($(this).attr("channel"),$(this).val()/100,function(k,l,m){var n=(m*100).toFixed(0);$("#span_"+k+"_"+l).text(n+"%");$("#slider_"+k+"_"+l).val(n)})}});c.table.append(j)}}this.readAll(function(k,n){for(d in n){var m=$("#slider_"+k+"_"+d);var l=$("#span_"+k+"_"+d);var o=0;if(m.attr("servo")=="true"){m.attr("min",-45);m.attr("max",45);o=n[d]["angle"];l.text(o+"°")}else{m.attr("min",0);m.attr("max",100);o=(n[d]["float"]*100).toFixed(0);l.text(o+"%")}m.val(o)}setTimeout(function(){b.refreshUI()},b.refreshTime)})};function Temperature(a){this.name=a;this.url="/devices/"+a+"/sensor";this.refreshTime=5000}Temperature.prototype.toString=function(){return this.name+": Temperature"};Temperature.prototype.getKelvin=function(a){$.get(this.url+"/temperature/k",function(b){a(this.name,b)})};Temperature.prototype.getCelsius=function(a){$.get(this.url+"/temperature/c",function(b){a(this.name,b)})};Temperature.prototype.getFahrenheit=function(a){$.get(this.url+"/temperature/f",function(b){a(this.name,b)})};Temperature.prototype.refreshUI=function(){var a=this;var b=this.element;if((b!=undefined)&&(b.header==undefined)){b.header=$("<h3>"+this+"</h3>");b.append(b.header)}this.getCelsius(function(c,d){if(b!=undefined){b.header.text(a+": "+d+"°C")}setTimeout(function(){a.refreshUI()},a.refreshTime)})};function Pressure(a){this.name=a;this.url="/devices/"+a+"/sensor";this.refreshTime=5000}Pressure.prototype.toString=function(){return this.name+": Pressure"};Pressure.prototype.getPascal=function(a){$.get(this.url+"/pressure/pa",function(b){a(this.name,b)})};Pressure.prototype.getHectoPascal=function(a){$.get(this.url+"/pressure/hpa",function(b){a(this.name,b)})};Pressure.prototype.refreshUI=function(){var b=this;var a=this.element;if((a!=undefined)&&(a.header==undefined)){a.header=$("<h3>"+this+"</h3>");a.append(a.header)}b.getHectoPascal(function(c,d){if(a!=undefined){a.header.text(b+": "+d+"hPa")}setTimeout(function(){b.refreshUI()},b.refreshTime)})};function Luminosity(a){this.name=a;this.url="/devices/"+a+"/sensor";this.refreshTime=1000}Luminosity.prototype.toString=function(){return this.name+": Luminosity"};Luminosity.prototype.getLux=function(a){$.get(this.url+"/luminosity/lux",function(b){a(this.name,b)})};Luminosity.prototype.refreshUI=function(){var a=this;var b=this.element;if((b!=undefined)&&(b.header==undefined)){b.header=$("<h3>"+this+"</h3>");b.append(b.header)}this.getLux(function(c,d){if(b!=undefined){b.header.text(a+": "+d+"lux")}setTimeout(function(){a.refreshUI()},a.refreshTime)})};function Distance(a){this.name=a;this.url="/devices/"+a+"/sensor";this.refreshTime=1000}Distance.prototype.toString=function(){return this.name+": Distance"};Distance.prototype.getMillimeter=function(a){$.get(this.url+"/distance/mm",function(b){a(this.name,b)})};Distance.prototype.refreshUI=function(){var b=this;var a=this.element;if((a!=undefined)&&(a.header==undefined)){a.header=$("<h3>"+this+"</h3>");a.append(a.header)}this.getMillimeter(function(c,d){if(a!=undefined){a.header.text(b+": "+d+"mm")}setTimeout(function(){b.refreshUI()},b.refreshTime)})};function PiFaceDigital(a){this.name=a;this.url="/devices/"+a+"/digital";this.onready=null;this.refreshTime=1000}PiFaceDigital.prototype.toString=function(){return"PiFaceDigital"};PiFaceDigital.prototype.input=function(b,c){var a=this.name;$.get(this.url+"/input/"+b,function(d){c(a,b,d)})};PiFaceDigital.prototype.output=function(b,c,d){var a=this.name;$.post(this.url+"/output/"+b+"/"+c,function(e){d(a,b,e)})};PiFaceDigital.prototype.readAll=function(b){var a=this.name;$.get(this.url+"/*",function(c){b(a,c)})};PiFaceDigital.prototype.refreshUI=function(){var c=this;var f=this.element;if((f!=undefined)&&(f.header==undefined)){f.header=$("<h3>"+this+"</h3>");f.append(f.header)}if((f!=undefined)&&(f.table==undefined)){f.header.text(this);f.table=$("<table>");f.append(f.table);var b=$("<tr>");b.append($("<td><b>Outputs</b></td>"));for(var e=7;e>=0;e--){var a=$("<td>");var d=webiopi().createButton(this.name+"_output_"+e,e,function(){if($("#"+c.name+"_output_"+$(this).attr("channel")).attr("class")=="LOW"){value=1}else{value=0}c.output($(this).attr("channel"),value,function(g,j,k){var h=$("#"+g+"_output_"+j);if(k=="1"){h.attr("class","HIGH")}else{h.attr("class","LOW")}})});d.attr("channel",e);d.attr("class","LOW");a.append(d);b.append(a)}f.table.append(b);b=$("<tr>");b.append($("<td><b>Inputs</b></td>"));for(var e=7;e>=0;e--){var a=$("<td>");var d=webiopi().createButton(this.name+"_input_"+e,e,function(){});d.attr("channel",e);d.attr("class","LOW");a.append(d);b.append(a)}f.table.append(b)}this.readAll(function(g,h){for(e in h.input){$("#"+g+"_input_"+e).attr("class",h.input[e]=="1"?"HIGH":"LOW")}for(e in h.output){$("#"+g+"_output_"+e).attr("class",h.output[e]=="1"?"HIGH":"LOW")}setTimeout(function(){c.refreshUI()},c.refreshTime)})};function Humidity(a){this.name=a;this.url="/devices/"+a+"/sensor";this.refreshTime=5000}Humidity.prototype.toString=function(){return this.name+": Humidity"};Humidity.prototype.getHumidity=function(a){$.get(this.url+"/humidity/float",function(b){a(this.name,b)})};Humidity.prototype.getHumidityPercent=function(a){$.get(this.url+"/humidity/percent",function(b){a(this.name,b)})};Humidity.prototype.refreshUI=function(){var a=this;var b=this.element;if((b!=undefined)&&(b.header==undefined)){b.header=$("<h3>"+this+"</h3>");b.append(b.header)}this.getHumidityPercent(function(c,d){if(b!=undefined){b.header.text(a+": "+d+"%")}setTimeout(function(){a.refreshUI()},a.refreshTime)})};